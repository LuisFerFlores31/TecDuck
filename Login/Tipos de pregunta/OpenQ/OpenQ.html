<!DOCTYPE html>
<html lang="es">
<head>
    <title>Respuesta Abierta</title>
    <link rel="stylesheet" href="styles.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Respuesta Abierta</title>
</head>
<body>
    <div class="container">
        <h1>Nueva Pregunta Respuesta Abierta</h1>
        <form id="open-question-form" action="OpenQ.php" method="POST">
            <div class="question">
                <label for="question-text">Pregunta:</label>
                <input type="text" id="question-text" name="question-text" required>
            </div>

            <input type="hidden" name="usuario" value="test@example.com"> <!-- Replace with dynamic user -->
            <div class="dropdowns">
                <div class="dropdown">
                    <label for="island">Isla:</label>
                    <select id="island" name="island" required>
                        <option value="" disabled selected>Selecciona una isla</option>
                        <option value=10>Isla 1</option>
                        <option value=20>Isla 2</option>
                        <option value=30>Isla 3</option>
                        <option value=40>Isla 4</option>
                        <option value=50>Isla 5</option>
                        <option value=60>Isla 6</option>
                        <option value=70>Isla 7</option>
                        <option value=80>Isla 8</option>
                        <option value=82>Isla 8.2</option>
                        <option value=83>Isla 8.3</option>
                        <option value=90>Isla 9</option>
                        <option value=92>Isla 9.2</option>
                        <option value=100>Isla 10</option>
                        <option value=102>Isla 10.2</option>
                    </select>
                </div>
                <div class="dropdown">
                    <label for="level">Nivel:</label>
                    <select id="level" name="level" required>
                        <option value="" disabled selected>Selecciona un nivel</option>
                        <option value=1>Nivel 1</option>
                        <option value=2>Nivel 2</option>
                        <option value=3>Nivel 3</option>
                    </select>
                </div>
            </div>

            <div class="answers">
                <div class="answer">
                    <label for="answer1">Respuesta 1:</label>
                    <input type="text" id="answer1" name="answer1" required>
                </div>
                <div class="answer">
                    <label for="answer2">Respuesta 2:</label>
                    <input type="text" id="answer2" name="answer2">
                </div>
                <div class="answer">
                    <label for="answer3">Respuesta 3:</label>
                    <input type="text" id="answer3" name="answer3">
                </div>
                <div class="answer">
                    <label for="answer4">Respuesta 4:</label>
                    <input type="text" id="answer4" name="answer4">
                </div>
            </div>
            <button type="submit">Guardar Pregunta</button>
        </form>
    </div>

    <div>
        <h2> Responder Pregunta </h2>
        <div class="response-box">
            <p id="display-question">Aquí aparecerá la pregunta</p>
            <input type="text" id="user-answer" placeholder="Escribe tu respuesta aquí">
            <button id="check-answer-button">Comprobar Respuesta</button>
            <p id="result-message"></p>
        </div>
        <a href="../SelectQ.html">Volver al Inicio</a>
    </div>

    <script>
        // Elimina el event.preventDefault() para permitir el envío normal del formulario
        /*
        document.getElementById('open-question-form').addEventListener('submit', function(event) {
            event.preventDefault();

            // Get the question and answers from the form
            const questionText = document.getElementById('question-text').value;
            const answer1 = document.getElementById('answer1').value;
            const answer2 = document.getElementById('answer2').value;
            const answer3 = document.getElementById('answer3').value;
            const answer4 = document.getElementById('answer4').value;

            // Update the display question
            document.getElementById('display-question').textContent = questionText;

            // Store the answers for comparison
            const answers = [answer1, answer2, answer3, answer4].filter(Boolean); // Remove empty answers
            document.getElementById('check-answer-button').dataset.answers = JSON.stringify(answers);

            // Show an alert to confirm the question was saved
            alert('Pregunta guardada con éxito!');
        });
        */
        document.getElementById('check-answer-button').addEventListener('click', function() {
            const userAnswer = document.getElementById('user-answer').value.trim().toLowerCase();
            const correctAnswers = JSON.parse(this.dataset.answers || '[]').map(a => a.toLowerCase());

            const resultMessage = correctAnswers.includes(userAnswer)
                ? '¡Respuesta correcta!'
                : 'Respuesta incorrecta. Intenta de nuevo.';
            document.getElementById('result-message').textContent = resultMessage;
        });
    </script>
</body>
</html>